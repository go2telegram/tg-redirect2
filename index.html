<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram‚Ä¶</title>
  <meta name="robots" content="noindex,nofollow" />

  <!-- Open Graph (–¥–ª—è –∫—Ä–∞—Å–∏–≤—ã—Ö –ø—Ä–µ–≤—å—é) -->
  <meta property="og:title" content="–û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram" />
  <meta property="og:description" content="–ë—ã—Å—Ç—Ä—ã–π –ø–µ—Ä–µ—Ö–æ–¥ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ Telegram –∏–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–∫—É ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ iOS, Android –∏ Desktop." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://USERNAME.github.io/tg-redirect/" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/9919?s=200&v=4" />

  <style>
    :root { --bg:#0f1115; --card:#161a22; --text:#e8ecf1; --muted:#a9b1bd; }
    * { box-sizing: border-box }
    html,body { height:100% }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji"; background:var(--bg); color:var(--text); display:grid; place-items:center }
    .card { width:min(820px, 92vw); background:var(--card); padding:28px; border-radius:20px; box-shadow: 0 10px 30px rgba(0,0,0,.35) }
    h1 { font-size: clamp(22px, 3.2vw, 28px); margin: 0 0 8px }
    p { color: var(--muted); line-height:1.5; margin: 8px 0 }
    .actions { display:flex; flex-wrap:wrap; gap:10px; margin-top:18px }
    .btn { appearance:none; border:none; padding:14px 16px; border-radius:14px; background:#2a3141; color:var(--text); cursor:pointer; font-weight:600; text-decoration:none; display:inline-flex; align-items:center; gap:10px }
    .btn.primary { background:#2385ff; color:white }
    .btn:focus { outline:2px solid #3c8dff66; outline-offset:2px }
    code { background:#0f131a; padding:2px 6px; border-radius:6px }
    .small { font-size: 13px; color: var(--muted); margin-top: 12px }
    .note { margin-top:14px; font-size:13px; color:#93a0af }
    .kbd { padding:0 6px; border:1px solid #263042; border-radius:6px; background:#0f131a; color:#e8ecf1 }
  </style>

  <!-- Yandex.Metrika counter (ID: 104141664) -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=104141664', 'ym');

    ym(104141664, 'init', {ssr:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/104141664" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</head>
<body>
  <div class="card">
    <h1>–û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram‚Ä¶</h1>
    <p>–°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–∞–º–∞ –≤—ã–±–µ—Ä–µ—Ç –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–±: –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ —É—Å—Ç–∞–Ω–æ–≤–∫—É. UTM –∏ –∫–ª–∏–∫–∏ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –ú–µ—Ç—Ä–∏–∫–µ.</p>

    <div class="actions">
      <a id="openAppBtn" class="btn primary" href="#">–û—Ç–∫—Ä—ã—Ç—å –≤ Telegram</a>
      <a id="openWebBtn" class="btn" href="#" rel="nofollow">–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</a>
      <a id="storeBtn" class="btn" href="#" rel="nofollow">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Telegram</a>
    </div>

    <p class="small">
      –ò—Å—Ç–æ—á–Ω–∏–∫: <code id="src">direct</code> ¬∑
      –ê–ª–∏–∞—Å—ã –ø—É—Ç–µ–π: <code>/yt</code>, <code>/ig</code>, <code>/tt</code>, <code>/ads</code> ¬∑
      –ö–∞–Ω–∞–ª—ã: <code>/c1</code>, <code>/c2</code>, <code>/c3</code> ¬∑
      –ö–æ–Ω—Ç–µ–Ω—Ç: <code>/v</code> (video), <code>/s</code> (shorts), <code>/live</code>, <code>/story</code>, <code>/bio</code>.
    </p>
    <p class="note">
      –ü—Ä–∏–º–µ—Ä—ã —Å—Å—ã–ª–æ–∫: <span class="kbd">/yt/c1/v</span>, <span class="kbd">/yt/c2/s</span>, <span class="kbd">/ig/c1/story</span>, <span class="kbd">/tt/c3/bio</span>, <span class="kbd">/ads/meta/c1</span>.<br/>
      UTM –∏–∑ query –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –∞–ª–∏–∞—Å—ã, –µ—Å–ª–∏ –∑–∞–¥–∞–Ω—ã (—Ä—É—á–Ω–æ–π –∫–æ–Ω—Ç—Ä–æ–ª—å —Å–∏–ª—å–Ω–µ–µ –ø—Ä–µ—Å–µ—Ç–∞).
    </p>
  </div>

  <script>
    // =====================
    // ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò
    // =====================
    // –ü—Ä–∏–≤–∞—Ç–Ω–∞—è –∏–Ω–≤–∞–π—Ç-—Å—Å—ã–ª–∫–∞ (https://t.me/+XXXX)
    const inviteCode = "+oQf2XIfajeg5MDVi";
    // –ü—É–±–ª–∏—á–Ω—ã–π @username, –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ (tg://resolve)
    const publicUsername = null; // –Ω–∞–ø—Ä–∏–º–µ—Ä: "pyat_kluchey_zdorovya" –∏–ª–∏ null

    // –ò–º–µ–Ω–∞ –∫–∞–Ω–∞–ª–æ–≤ –¥–ª—è utm_campaign (–∑–∞–¥–∞–π —á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–µ)
    const channelNames = {
      c1: "main",
      c2: "second",
      c3: "third"
    };

    // –ê–≤—Ç–æ–æ—Ç–∫—Ä—ã—Ç–∏–µ deep link
    const preferDeepLink = true;

    // =====================
    // üöÄ –õ–û–ì–ò–ö–ê UTM/–ü–†–ï–°–ï–¢–û–í
    // =====================
    const qs = new URLSearchParams(location.search);
    const utms = new URLSearchParams();
    const UTM_KEYS = ["utm_source","utm_medium","utm_campaign","utm_content","utm_term","s","src","ref","gclid","fbclid","ttclid","yclid"];
    UTM_KEYS.forEach(k=>{ if(qs.get(k)) utms.set(k, qs.get(k)); });

    // –ê–ª–∏–∞—Å—ã –ø–æ pathname: /<platform>/<channel>/<kind>
    // platform: yt | ig | tt | ads
    // channel:  c1 | c2 | c3 (—Ç—Ä–∏ —Ç–≤–æ–∏—Ö –∫–∞–Ω–∞–ª–∞/–∞–∫–∫–∞—É–Ω—Ç–∞)
    // kind:     v | s | live | story | bio | reels | profile
    const path = (location.pathname || '').replace(/\/+$/,'').toLowerCase();
    const parts = path.split('/').filter(Boolean); // ['', 'yt', 'c1', 'v'] -> ['yt','c1','v']

    function applyPreset(parts){
      if (!parts.length) return;

      const platform = parts[0];             // yt/ig/tt/ads
      const ch = parts[1];                   // c1/c2/c3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
      const kind = parts[2];                 // v/s/live/story/bio/... (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

      const chName = channelNames[ch] || ch || 'na';

      if (platform === 'yt') {
        if (!utms.get('utm_source')) utms.set('utm_source','youtube');
        // medium –ø–æ —Ç–∏–ø—É
        if (!utms.get('utm_medium')) {
          if (kind === 's') utms.set('utm_medium','shorts');
          else if (kind === 'live') utms.set('utm_medium','live');
          else utms.set('utm_medium','video');
        }
        if (!utms.get('utm_campaign')) utms.set('utm_campaign', `yt_${chName}`);
        if (!utms.get('utm_content') && kind) utms.set('utm_content', kind);
      }

      if (platform === 'ig') {
        if (!utms.get('utm_source')) utms.set('utm_source','instagram');
        if (!utms.get('utm_medium')) {
          if (kind === 'story') utms.set('utm_medium','story');
          else if (kind === 'reels') utms.set('utm_medium','reels');
          else if (kind === 'bio') utms.set('utm_medium','bio');
          else utms.set('utm_medium','post');
        }
        if (!utms.get('utm_campaign')) utms.set('utm_campaign', `ig_${chName}`);
        if (!utms.get('utm_content') && kind) utms.set('utm_content', kind);
      }

      if (platform === 'tt') {
        if (!utms.get('utm_source')) utms.set('utm_source','tiktok');
        if (!utms.get('utm_medium')) {
          if (kind === 'bio') utms.set('utm_medium','bio');
          else utms.set('utm_medium','video');
        }
        if (!utms.get('utm_campaign')) utms.set('utm_campaign', `tt_${chName}`);
        if (!utms.get('utm_content') && kind) utms.set('utm_content', kind);
      }

      if (platform === 'ads') {
        // /ads/<network>/<channel?>
        const net = ch || 'meta';
        if (!utms.get('utm_source')) utms.set('utm_source', net); // meta/google/tiktok/yandex/vk
        if (!utms.get('utm_medium')) utms.set('utm_medium','ads');
        if (!utms.get('utm_campaign')) utms.set('utm_campaign', `ads_${chName}`);
        if (!utms.get('utm_content') && kind) utms.set('utm_content', kind);
      }
    }
    applyPreset(parts);

    // –û—Ç–ø—Ä–∞–≤–∏–º UTM –≤ –ú–µ—Ç—Ä–∏–∫—É –∫–∞–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–∏–∑–∏—Ç–∞
    try { ym(104141664, 'params', { utm: Object.fromEntries(utms.entries()) }); } catch (_) {}

    // –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏
    const srcText = utms.get("utm_source") || qs.get("src") || (document.referrer ? new URL(document.referrer).hostname : "direct");
    document.getElementById('src').textContent = srcText;

    // =====================
    // üîó –°–°–´–õ–ö–ò –ò –†–ï–î–ò–†–ï–ö–¢–´
    // =====================
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    const isAndroid = /android/i.test(ua);
    const isIOS = /iPad|iPhone|iPod/.test(ua) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);

    const tmeBase = publicUsername ? `https://t.me/${publicUsername}` : `https://t.me/${inviteCode}`;
    const tgDeep = publicUsername ? `tg://resolve?domain=${publicUsername}` : `tg://join?invite=${inviteCode.replace('+','')}`;
    const webTg = publicUsername ? `https://web.telegram.org/k/#@${publicUsername}` : tmeBase;

    const storeIOS = `https://apps.apple.com/app/telegram-messenger/id686449807`;
    const storeAndroid = `https://play.google.com/store/apps/details?id=org.telegram.messenger`;

    function withUTM(url){
      if(!utms.toString()) return url;
      const u = new URL(url);
      utms.forEach((v,k)=>u.searchParams.set(k,v));
      return u.toString();
    }

    const elOpen  = document.getElementById('openAppBtn');
    const elWeb   = document.getElementById('openWebBtn');
    const elStore = document.getElementById('storeBtn');

    elWeb.href   = withUTM(webTg);
    elStore.href = withUTM(isIOS ? storeIOS : storeAndroid);

    function tryOpenApp(){
      if (sessionStorage.getItem('opened')) return;
      sessionStorage.setItem('opened','1');

      const universalUrl = withUTM(tmeBase);
      let didHide = false;
      const onHide = () => { didHide = true; cleanup(); };
      const cleanup = () => {
        document.removeEventListener('visibilitychange', onHide);
        window.removeEventListener('pagehide', onHide);
        window.removeEventListener('blur', onHide);
      };
      document.addEventListener('visibilitychange', onHide);
      window.addEventListener('pagehide', onHide);
      window.addEventListener('blur', onHide);

      if(isIOS){
        location.href = universalUrl;
        setTimeout(() => { if(!didHide) location.href = withUTM(storeIOS); }, 1500);
      } else if(isAndroid){
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = tgDeep;
        document.body.appendChild(iframe);

        setTimeout(() => { if(!didHide) location.href = universalUrl; }, 800);
        setTimeout(() => { if(!didHide) location.href = withUTM(storeAndroid); }, 1800);
      } else {
        location.href = universalUrl;
      }
    }

    elOpen.addEventListener('click', (e)=>{ e.preventDefault(); tryOpenApp(); });

    if (preferDeepLink) setTimeout(tryOpenApp, 250);

    [elOpen, elWeb, elStore].forEach(a=>a.setAttribute('target','_top'));

    // –ú–µ—Ç—Ä–∏–∫–∞: —Ü–µ–ª–∏ –∫–ª–∏–∫–æ–≤
    [elOpen, elWeb, elStore].forEach(a=>{
      a.addEventListener('click',()=>{
        try {
          if (a.id === 'openAppBtn') ym(104141664, 'reachGoal', 'open_app');
          if (a.id === 'openWebBtn') ym(104141664, 'reachGoal', 'open_web');
          if (a.id === 'storeBtn')   ym(104141664, 'reachGoal', 'open_store');
          console.log('click:', a.id, { utm: Object.fromEntries(utms.entries()) });
        } catch(_) {}
      });
    });

    // A/B –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞–¥–µ—Ä–∂–µ–∫ (–Ω–∞–ø—Ä–∏–º–µ—Ä ?ab=fast)
    const ab = (qs.get('ab')||'').toLowerCase();
    if (ab === 'fast') {
      // –ú–æ–∂–Ω–æ —É—Å–∫–æ—Ä–∏—Ç—å —Ç–∞–π–º–∏–Ω–≥–∏, –µ—Å–ª–∏ –∑–∞—Ö–æ—Ç–∏—Ç–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–≤–µ—Ä—Å–∏—é
      // (–æ—Å—Ç–∞–≤–ª–µ–Ω–æ –∫–∞–∫ –ø—Ä–∏–º–µ—Ä ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)
    }
  </script>
</body>
</html>
