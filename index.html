<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram‚Ä¶</title>
  <meta name="robots" content="noindex,nofollow" />

  <!-- Open Graph -->
  <meta property="og:title" content="–û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram" />
  <meta property="og:description" content="–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –≤ Telegram. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚Äî –º—ã –ø–æ–¥—Å–∫–∞–∂–µ–º, –∫–∞–∫ –µ–≥–æ —Å–∫–∞—á–∞—Ç—å." />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="https://USERNAME.github.io/tg-redirect/" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/9919?s=200&v=4" />

  <style>
    :root { --bg:#0f1115; --card:#161a22; --text:#e8ecf1; --muted:#a9b1bd; }
    * { box-sizing: border-box }
    html,body { height:100% }
    body { margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji"; background:var(--bg); color:var(--text); display:grid; place-items:center }
    .card { width:min(820px, 92vw); background:var(--card); padding:28px; border-radius:20px; box-shadow: 0 10px 30px rgba(0,0,0,.35) }
    h1 { font-size: clamp(22px, 3.2vw, 28px); margin: 0 0 8px }
    p { color: var(--muted); line-height:1.5; margin: 8px 0 }
    .actions { display:flex; flex-wrap:wrap; gap:10px; margin-top:18px }
    .btn { appearance:none; border:none; padding:14px 16px; border-radius:14px; background:#2a3141; color:var(--text); cursor:pointer; font-weight:600; text-decoration:none; display:inline-flex; align-items:center; gap:10px }
    .btn.primary { background:#2385ff; color:white }
    .btn:focus { outline:2px solid #3c8dff66; outline-offset:2px }
    .note { margin-top:14px; font-size:13px; color:#93a0af }
  </style>

  <!-- Yandex.Metrika counter (ID: 104141664) -->
<script type="text/javascript">
    (function(m,e,t,r,i,k,a){
        m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
        m[i].l=1*new Date();
        for (var j = 0; j < document.scripts.length; j++) {if (document.scripts[j].src === r) { return; }}
        k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)
    })(window, document,'script','https://mc.yandex.ru/metrika/tag.js?id=104141664', 'ym');

    ym(104141664, 'init', {ssr:true, clickmap:true, ecommerce:"dataLayer", accurateTrackBounce:true, trackLinks:true});
    ym(104141664, 'reachGoal', 'visit');
</script>
<noscript><div><img src="https://mc.yandex.ru/watch/104141664" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
<!-- /Yandex.Metrika counter -->
</head>
<body>
  <div class="card">
    <h1>–û—Ç–∫—Ä—ã–≤–∞–µ–º Telegram‚Ä¶</h1>
    <p>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –ø–µ—Ä–µ–π—Ç–∏ –≤ Telegram. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚Äî –º—ã –ø–æ–¥—Å–∫–∞–∂–µ–º, –∫–∞–∫ –µ–≥–æ —Å–∫–∞—á–∞—Ç—å.</p>

    <div class="actions">
      <a id="openAppBtn" class="btn primary" href="#">–û—Ç–∫—Ä—ã—Ç—å –≤ Telegram</a>
      <a id="openWebBtn" class="btn" href="#" rel="nofollow">–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ</a>
      <a id="storeBtn" class="btn" href="#" rel="nofollow">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Telegram</a>
      <a id="copyBtn" class="btn" href="#" rel="nofollow">–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</a>
    </div>

    <p class="note" id="hint" style="display:none;">
      –ü–æ—Ö–æ–∂–µ, –≤—ã –æ—Ç–∫—Ä—ã–ª–∏ —Å—Å—ã–ª–∫—É –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (Instagram/TikTok). –ù–∞–∂–º–∏—Ç–µ <b>‚ãØ</b> –∏ –≤—ã–±–µ—Ä–∏—Ç–µ <b>–û—Ç–∫—Ä—ã—Ç—å –≤ Safari/–±—Ä–∞—É–∑–µ—Ä–µ</b>. –õ–∏–±–æ —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É –∏ –≤—Å—Ç–∞–≤—å—Ç–µ –≤—Ä—É—á–Ω—É—é.
    </p>
  </div>

  <script>
    // =====================
    // ‚öôÔ∏è –ù–ê–°–¢–†–û–ô–ö–ò
    // =====================
    const inviteCode = "+oQf2XIfajeg5MDVi"; // –ø—Ä–∏–≤–∞—Ç–Ω–∞—è –∏–Ω–≤–∞–π—Ç-—Å—Å—ã–ª–∫–∞
    const publicUsername = null;             // @username, –µ—Å–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è
    const channelNames = { c1: "main", c2: "second", c3: "third" };

    // =====================
    // Helpers
    // =====================
    const UA = (navigator.userAgent || '') + ' ' + (navigator.vendor || '');
    const REF = (document.referrer || '').toLowerCase();

    function isIOS(){
      const p = navigator.platform || '';
      return /iPhone|iPad|iPod/i.test(UA) ||
             /iP(hone|ad|od)/i.test(p) ||
             ((/Mac|Macintosh/i.test(UA+p)) && (navigator.maxTouchPoints||0) > 1);
    }
    function isAndroid(){ return /android/i.test(UA); }

    function isInApp(){
      const patterns = /(Instagram|FBAN|FBAV|Line|YaApp_Android|YaApp_iOS|OKApp|VK(Client|Share)|Twitter|WeChat|Pinterest|Snapchat|LinkedIn|GSA|DuckDuckGo|CriOS)/i;
      const tiktok = /(TikTok|TTWebView|BytedanceWebview|Aweme|musical\.ly)/i;
      return patterns.test(UA) || tiktok.test(UA) || REF.includes('tiktok.com') || REF.includes('instagram.com');
    }

    // —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Å—Ç–∞—Ä—Ç–æ–º: –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –í–´–ö–õ, –≤–∫–ª—é—á–∞–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ in-app –∏ –Ω–µ –∑–∞–ø—Ä–µ—â–µ–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º
    const qp = new URLSearchParams(location.search);
    const autoParam = qp.get('auto'); // auto=1 –≤–∫–ª—é—á–∞–µ—Ç –Ω–∞—Å–∏–ª—å–Ω–æ, auto=0 –≤—ã–∫–ª—é—á–∞–µ—Ç
    let preferDeepLink = false;
    if (autoParam === '1') preferDeepLink = true;
    else if (autoParam === '0') preferDeepLink = false;
    else {
      preferDeepLink = !isInApp() && (isIOS() || isAndroid());
    }

    // –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–¥—Å–∫–∞–∑–∫—É –≤ in-app
    if (isInApp()) {
      const hint = document.getElementById('hint');
      if (hint) hint.style.display = 'block';
    }

    // =====================
    // üîó –°–°–´–õ–ö–ò –ò –†–ï–î–ò–†–ï–ö–¢–´
    // =====================
    const tmeBase = publicUsername ? `https://t.me/${publicUsername}` : `https://t.me/${inviteCode}`;
    const tgDeep = publicUsername ? `tg://resolve?domain=${publicUsername}` : `tg://join?invite=${inviteCode.replace('+','')}`;
    const webTg = publicUsername ? `https://web.telegram.org/k/#@${publicUsername}` : tmeBase;

    const storeIOS = `https://apps.apple.com/app/telegram-messenger/id686449807`;
    const storeAndroid = `https://play.google.com/store/apps/details?id=org.telegram.messenger`;
    const storeDesktop = `https://telegram.org/apps`;

    function withUTM(url){
      const utms = new URLSearchParams();
      const qs = new URLSearchParams(location.search);
      ["utm_source","utm_medium","utm_campaign","utm_content","utm_term","s","src","ref","gclid","fbclid","ttclid","yclid"].forEach(k=>{
        const v = qs.get(k);
        if (v) utms.set(k, v);
      });
      if(!utms.toString()) return url;
      const u = new URL(url);
      utms.forEach((v,k)=>u.searchParams.set(k,v));
      return u.toString();
    }

    const elOpen  = document.getElementById('openAppBtn');
    const elWeb   = document.getElementById('openWebBtn');
    const elStore = document.getElementById('storeBtn');
    const elCopy  = document.getElementById('copyBtn');

    elWeb.href = withUTM(webTg);

    elStore.addEventListener('click', (e)=>{
      e.preventDefault();
      let target = storeDesktop;
      if (isIOS()) target = storeIOS;
      else if (isAndroid()) target = storeAndroid;
      location.href = withUTM(target);
      try { ym(104141664, 'reachGoal', 'open_store'); } catch(_) {}
    });

    elCopy.addEventListener('click', async (e)=>{
      e.preventDefault();
      const universalUrl = withUTM(tmeBase);
      try { await navigator.clipboard.writeText(universalUrl); elCopy.textContent = '–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞'; ym(104141664, 'reachGoal', 'copy_link'); } catch(_) { alert('–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å—Å—ã–ª–∫—É:\\n' + universalUrl); }
    });

    function tryOpenApp(){
      if (sessionStorage.getItem('opened')) return;
      sessionStorage.setItem('opened','1');

      const universalUrl = withUTM(tmeBase);
      let didHide = false;
      const onHide = () => { didHide = true; cleanup(); };
      const cleanup = () => {
        document.removeEventListener('visibilitychange', onHide);
        window.removeEventListener('pagehide', onHide);
        window.removeEventListener('blur', onHide);
      };
      document.addEventListener('visibilitychange', onHide);
      window.addEventListener('pagehide', onHide);
      window.addEventListener('blur', onHide);

      if(isIOS()){
        setTimeout(()=>{ location.href = universalUrl; }, 700);
        setTimeout(() => { if(!didHide) location.href = withUTM(storeIOS); }, 2200);
      } else if(isAndroid()){
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none';
        iframe.src = tgDeep;
        document.body.appendChild(iframe);

        setTimeout(() => { if(!didHide) location.href = universalUrl; }, 900);
        setTimeout(() => { if(!didHide) location.href = withUTM(storeAndroid); }, 2200);
      } else {
        location.href = universalUrl;
      }
    }

    elOpen.addEventListener('click', (e)=>{ e.preventDefault(); tryOpenApp(); });

    if (preferDeepLink) setTimeout(tryOpenApp, 350);

    [elOpen, elWeb, elStore, elCopy].forEach(a=>a.setAttribute('target','_top'));
  </script>
</body>
</html>
